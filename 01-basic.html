<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>01. åŸºç¤åŠŸèƒ½æ¸¬è©¦ï¼ˆPyScript æ–°ç‰ˆï¼‰</title>

  <!-- âœ… ä½¿ç”¨å›ºå®šç‰ˆæœ¬çš„ PyScript Core -->
  <link rel="stylesheet" href="https://pyscript.net/releases/2024.1.1/core.css">
  <script type="module" src="https://pyscript.net/releases/2024.1.1/core.js"></script>

  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Noto Sans TC", sans-serif;
      line-height: 1.6;
      color: #333;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      padding: 30px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.2);
    }
    h1 { color: #667eea; margin-bottom: 10px; font-size: 2em; }
    h3 { color: #555; margin-top: 20px; margin-bottom: 10px; }
    .subtitle { color: #666; font-size: 1.1em; margin-bottom: 30px; }
    .card {
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      padding: 20px;
      margin: 15px 0;
      background: #fafafa;
    }
    .info {
      background: #e3f2fd;
      border-left: 4px solid #2196f3;
      padding: 15px;
      margin: 15px 0;
      border-radius: 4px;
    }
    .warning {
      background: #fff3cd;
      border-left: 4px solid #ff9800;
      padding: 15px;
      margin: 15px 0;
      border-radius: 4px;
    }
    button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 1em;
      margin: 5px;
      transition: transform 0.2s;
    }
    button:hover { transform: translateY(-2px); }
    button.secondary { background: #6c757d; }
    input {
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-size: 1em;
      margin: 5px;
    }
    .output-box {
      background: #f5f5f5;
      border: 1px solid #ddd;
      border-radius: 6px;
      padding: 15px;
      max-height: 300px;
      overflow-y: auto;
      font-family: 'Courier New', monospace;
      font-size: 0.9em;
      white-space: pre-wrap;
    }
    .row {
      display: flex;
      gap: 15px;
      align-items: center;
      flex-wrap: wrap;
      margin: 10px 0;
    }
    .metric {
      background: white;
      padding: 15px 20px;
      border-radius: 8px;
      margin: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      text-align: center;
    }
    .metric-value {
      font-size: 2em;
      font-weight: bold;
      color: #667eea;
    }
    .metric-label {
      color: #666;
      font-size: 0.9em;
      margin-top: 5px;
    }
    .status-indicator {
      display: inline-block;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      margin-right: 8px;
    }
    .status-loading { background: #ff9800; }
    .status-ready { background: #4caf50; }
    .status-error { background: #f44336; }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ PyScript åŸºç¤åŠŸèƒ½æ¸¬è©¦ï¼ˆæ–°ç‰ˆ Coreï¼‰</h1>
    <p class="subtitle">ä½¿ç”¨ PyScript 2024.1.1 ç©©å®šç‰ˆæœ¬</p>

    <div class="info">
      <strong>âœ… æœ¬ç‰ˆæœ¬æ”¹é€²</strong>
      <ul style="margin-left: 20px; margin-top: 10px;">
        <li>ä½¿ç”¨å›ºå®šç‰ˆæœ¬ (2024.1.1) è€Œé latest</li>
        <li>æ”¹ç”¨ core.js (type="module") é¿å… CORB</li>
        <li>æ˜ç¢ºæŒ‡å®š packages = ["numpy"]</li>
        <li>å»ºè­°ä½¿ç”¨ http-server è€Œé file://</li>
      </ul>
    </div>

    <!-- è¼‰å…¥ç‹€æ…‹ -->
    <div class="card">
      <h3>è¼‰å…¥ç‹€æ…‹</h3>
      <div class="row">
        <span class="status-indicator status-loading" id="status-dot"></span>
        <span id="status-text">PyScript åˆå§‹åŒ–ä¸­...</span>
      </div>
      <div id="load-detail" style="margin-top: 10px; color: #666;"></div>
    </div>

    <!-- æ¸¬è©¦ 1: DOM æ“ä½œ -->
    <div class="card">
      <h3>æ¸¬è©¦ 1: DOM æ“ä½œ</h3>
      <div class="row">
        <input type="text" id="input1" placeholder="è¼¸å…¥æ–‡å­—..." value="Hello PyScript">
        <button id="btn-update">æ›´æ–°é¡¯ç¤º</button>
        <button id="btn-clear" class="secondary">æ¸…ç©º</button>
      </div>
      <div class="output-box" id="output1">ç­‰å¾…æ“ä½œ...</div>
    </div>

    <!-- æ¸¬è©¦ 2: Numpy è¨ˆç®— -->
    <div class="card">
      <h3>æ¸¬è©¦ 2: Numpy é™£åˆ—é‹ç®—</h3>
      <div class="row">
        <input type="number" id="array-size" value="1000" min="100" max="10000" step="100">
        <button id="btn-compute">åŸ·è¡Œè¨ˆç®—</button>
      </div>
      <div class="output-box" id="output2">ç­‰å¾…è¨ˆç®—...</div>
    </div>

    <!-- æ¸¬è©¦ 3: äº‹ä»¶è™•ç† -->
    <div class="card">
      <h3>æ¸¬è©¦ 3: äº‹ä»¶è™•ç†</h3>
      <div class="row">
        <button id="btn-click">é»æ“Š</button>
        <button id="btn-dblclick">é›™æ“Š</button>
        <input type="range" id="slider" min="0" max="100" value="50">
        <span id="slider-value">50</span>
      </div>
      <div class="output-box" id="output3">ç­‰å¾…äº‹ä»¶...</div>
    </div>

    <!-- æ•ˆèƒ½çµ±è¨ˆ -->
    <div class="card">
      <h3>æ•ˆèƒ½çµ±è¨ˆ</h3>
      <div class="row">
        <div class="metric">
          <div class="metric-value" id="event-count">0</div>
          <div class="metric-label">äº‹ä»¶æ¬¡æ•¸</div>
        </div>
        <div class="metric">
          <div class="metric-value" id="load-time">--</div>
          <div class="metric-label">è¼‰å…¥æ™‚é–“ (ç§’)</div>
        </div>
      </div>
    </div>
  </div>

  <!-- âœ… PyScript é…ç½®ï¼šæ˜ç¢ºæŒ‡å®šå¥—ä»¶ -->
  <py-config>
    packages = ["numpy"]
  </py-config>

  <!-- âœ… PyScript ç¨‹å¼ç¢¼ -->
  <script type="py">
from pyscript import document, window
import time

start_time = time.time()
event_count = 0

def timestamp():
    return time.strftime('%H:%M:%S')

def update_count():
    global event_count
    event_count += 1
    document.querySelector("#event-count").innerText = str(event_count)

# æ¸¬è©¦ 1: DOM æ“ä½œ
def update_output(*args):
    update_count()
    val = document.querySelector("#input1").value
    output = document.querySelector("#output1")
    output.innerText = f"[{timestamp()}] è¼¸å…¥: {val}\nå­—æ•¸: {len(val)}"

def clear_input(*args):
    update_count()
    document.querySelector("#input1").value = ""
    document.querySelector("#output1").innerText = "å·²æ¸…ç©º"

# æ¸¬è©¦ 2: Numpy è¨ˆç®—
def compute_numpy(*args):
    import numpy as np
    update_count()
    
    size = int(document.querySelector("#array-size").value)
    output = document.querySelector("#output2")
    output.innerText = f"è¨ˆç®— {size} å€‹å…ƒç´ ...\n"
    
    t0 = time.perf_counter()
    arr = np.random.rand(size).astype(np.float32)
    mean = np.mean(arr)
    std = np.std(arr)
    t1 = time.perf_counter()
    
    elapsed = t1 - t0
    output.innerText += f"""
âœ… å®Œæˆï¼
é™£åˆ—å¤§å°: {size}
å¹³å‡å€¼: {mean:.6f}
æ¨™æº–å·®: {std:.6f}
è€—æ™‚: {elapsed:.3f} ç§’
"""

# æ¸¬è©¦ 3: äº‹ä»¶è™•ç†
def handle_click(*args):
    update_count()
    document.querySelector("#output3").innerText = f"[{timestamp()}] å–®æ“Šäº‹ä»¶"

def handle_dblclick(*args):
    update_count()
    document.querySelector("#output3").innerText = f"[{timestamp()}] é›™æ“Šäº‹ä»¶"

def handle_slider(*args):
    update_count()
    val = document.querySelector("#slider").value
    document.querySelector("#slider-value").innerText = val

# ç¶å®šäº‹ä»¶
document.querySelector("#btn-update").addEventListener("click", update_output)
document.querySelector("#btn-clear").addEventListener("click", clear_input)
document.querySelector("#btn-compute").addEventListener("click", compute_numpy)
document.querySelector("#btn-click").addEventListener("click", handle_click)
document.querySelector("#btn-dblclick").addEventListener("dblclick", handle_dblclick)
document.querySelector("#slider").addEventListener("input", handle_slider)

# åˆå§‹åŒ–å®Œæˆ
end_time = time.time()
load_time = end_time - start_time

document.querySelector("#status-dot").className = "status-indicator status-ready"
document.querySelector("#status-text").innerText = "PyScript å·²å°±ç·’"
document.querySelector("#load-detail").innerText = f"âœ… è¼‰å…¥å®Œæˆï¼Œè€—æ™‚ {load_time:.2f} ç§’"
document.querySelector("#load-time").innerText = f"{load_time:.2f}"

print(f"âœ… PyScript åˆå§‹åŒ–å®Œæˆ ({load_time:.2f}s)")
  </script>

  <!-- JS è¼”åŠ©ï¼šè¼‰å…¥å¤±æ•—è™•ç† -->
  <script>
    // 30 ç§’è¶…æ™‚æª¢æ¸¬
    setTimeout(() => {
      const statusText = document.getElementById('status-text').textContent;
      if (statusText.includes('åˆå§‹åŒ–ä¸­')) {
        document.getElementById('status-dot').className = 'status-indicator status-error';
        document.getElementById('status-text').textContent = 'è¼‰å…¥è¶…æ™‚';
        document.getElementById('load-detail').innerHTML = 
          'âŒ PyScript è¼‰å…¥å¤±æ•—<br>è«‹æª¢æŸ¥ï¼š<br>1. ç¶²è·¯é€£ç·š<br>2. ä½¿ç”¨ http-serverï¼ˆé file://ï¼‰<br>3. é˜²ç«ç‰†è¨­å®š';
      }
    }, 30000);

    console.log('â³ ç­‰å¾… PyScript åˆå§‹åŒ–...');
  </script>
</body>
</html>
